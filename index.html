<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator BMI - Cek Berat Badan Ideal</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@700;800&display=swap"
        rel="stylesheet">
    <style>
        /* Additional responsive fixes for very small screens */
        @media (max-width: 384px) {
            body {
                padding: 10px !important;
            }

            .container {
                padding: 0 10px !important;
            }

            .calculator-card {
                padding: 1rem !important;
                margin: 0 -10px !important;
                width: calc(100% + 20px) !important;
                border-radius: 12px !important;
            }

            .calculator-form {
                padding: 0 !important;
                border: none !important;
                border-bottom: 2px solid #e9ecef !important;
                padding-bottom: 1.5rem !important;
                margin-bottom: 1.5rem !important;
            }

            .form-group {
                margin-bottom: 1.2rem !important;
            }

            .input-with-unit input {
                padding: 12px 14px !important;
                font-size: 1rem !important;
                max-width: 100% !important;
                box-sizing: border-box !important;
            }

            .unit {
                right: 14px !important;
                font-size: 0.85rem !important;
            }

            .gender-selection {
                grid-template-columns: 1fr !important;
                gap: 0.5rem !important;
            }

            .gender-card {
                padding: 1rem !important;
            }

            .calculate-btn {
                padding: 14px 16px !important;
                font-size: 1rem !important;
                width: 100% !important;
                margin-top: 1rem !important;
            }

            .result-placeholder {
                padding: 1.5rem 1rem !important;
            }

            .placeholder-icon {
                font-size: 2.5rem !important;
                margin-bottom: 1rem !important;
            }

            .result-placeholder h3 {
                font-size: 1.2rem !important;
                margin-bottom: 0.8rem !important;
            }

            .result-placeholder p {
                font-size: 0.9rem !important;
                margin-bottom: 1rem !important;
            }

            .placeholder-features li {
                font-size: 0.8rem !important;
                padding: 6px 8px !important;
            }

            /* Fix for result display on small screens */
            .result-main {
                padding: 1.2rem !important;
                overflow-x: hidden !important;
            }

            .bmi-number {
                font-size: 2.5rem !important;
            }

            .bmi-category {
                font-size: 0.9rem !important;
                padding: 8px 16px !important;
                white-space: nowrap !important;
                overflow: hidden !important;
                text-overflow: ellipsis !important;
            }

            .bmi-details {
                grid-template-columns: 1fr !important;
                padding: 1rem !important;
                gap: 0.8rem !important;
            }

            .detail-item {
                padding: 0.8rem !important;
            }

            .detail-value {
                font-size: 1.1rem !important;
            }

            .result-actions {
                grid-template-columns: 1fr !important;
                gap: 0.8rem !important;
            }

            .btn-tips,
            .btn-reset {
                padding: 12px 16px !important;
                font-size: 0.9rem !important;
                width: 100% !important;
                box-sizing: border-box !important;
            }

            .advice-box {
                padding: 1rem !important;
            }

            .advice-box h4 {
                font-size: 1rem !important;
            }

            .advice-box p {
                font-size: 0.85rem !important;
            }

            .bmi-bar {
                padding: 1rem !important;
            }

            .bar-labels span {
                font-size: 0.7rem !important;
            }

            /* Categories section fix */
            .categories-section {
                padding: 1.5rem 1rem !important;
                margin: 1rem -10px !important;
                width: calc(100% + 20px) !important;
                border-radius: 12px !important;
            }

            .categories-title {
                font-size: 1.1rem !important;
                white-space: normal !important;
                line-height: 1.4 !important;
                margin-bottom: 1rem !important;
            }

            .categories-grid {
                grid-template-columns: 1fr !important;
                gap: 0.8rem !important;
            }

            .category-card {
                padding: 1.2rem 1rem !important;
            }

            .category-icon {
                font-size: 1.5rem !important;
                margin-bottom: 0.8rem !important;
            }

            .category-card h4 {
                font-size: 1rem !important;
            }

            .category-card p {
                font-size: 0.85rem !important;
            }

            /* Section header fix */
            .section-header h2 {
                font-size: 1.4rem !important;
            }

            .section-header p {
                font-size: 0.9rem !important;
                padding: 0 10px !important;
            }

            /* Ensure no horizontal scroll */
            html,
            body {
                overflow-x: hidden !important;
                max-width: 100% !important;
                position: relative !important;
            }

            /* Fix for any overflowing elements */
            * {
                max-width: 100% !important;
            }
        }

        /* Additional fixes for 320-384px range */
        @media (max-width: 400px) and (min-width: 321px) {
            .calculator-card {
                padding: 1.2rem !important;
            }

            .bmi-number {
                font-size: 3rem !important;
            }

            .result-main {
                padding: 1.5rem !important;
            }
        }

        /* Fix for iOS Safari input zoom */
        @media screen and (max-width: 384px) {

            input,
            select,
            textarea {
                font-size: 16px !important;
                /* Prevents iOS zoom on focus */
            }
        }
    </style>
</head>

<body>
    <!-- Calculator Section -->
    <section class="calculator-section">
        <div class="container">
            <div class="section-header">
                <h2><i class="fas fa-calculator"></i> Kalkulator BMI</h2>
                <p>Hitung Body Mass Index (BMI) untuk mengetahui status berat badan Anda</p>
            </div>

            <div class="calculator-card">
                <div class="calculator-form">
                    <form id="bmiForm">
                        <div class="form-group">
                            <label for="weight">
                                <i class="fas fa-weight"></i> Berat Badan
                            </label>
                            <div class="input-with-unit">
                                <input type="number" id="weight" placeholder="Contoh: 65" min="1" max="300" step="0.1"
                                    required>
                                <span class="unit">kg</span>
                            </div>
                            <div class="input-hint">Masukkan berat badan dalam kilogram</div>
                            <div class="validation-message" id="weightError"></div>
                        </div>

                        <div class="form-group">
                            <label for="height">
                                <i class="fas fa-ruler-vertical"></i> Tinggi Badan
                            </label>
                            <div class="input-with-unit">
                                <input type="number" id="height" placeholder="Contoh: 170" min="50" max="300" step="0.1"
                                    required>
                                <span class="unit">cm</span>
                            </div>
                            <div class="input-hint">Masukkan tinggi badan dalam centimeter</div>
                            <div class="validation-message" id="heightError"></div>
                        </div>

                        <div class="form-group">
                            <label for="age">
                                <i class="fas fa-birthday-cake"></i> Usia
                            </label>
                            <div class="input-with-unit">
                                <input type="number" id="age" placeholder="Contoh: 25" min="1" max="120" required>
                                <span class="unit">tahun</span>
                            </div>
                            <div class="input-hint">Masukkan usia Anda</div>
                            <div class="validation-message" id="ageError"></div>
                        </div>

                        <div class="form-group">
                            <label>
                                <i class="fas fa-venus-mars"></i> Jenis Kelamin
                            </label>
                            <div class="gender-selection">
                                <label class="gender-option">
                                    <input type="radio" name="gender" value="male" checked>
                                    <div class="gender-card">
                                        <i class="fas fa-male"></i>
                                        <span>Laki-laki</span>
                                    </div>
                                </label>
                                <label class="gender-option">
                                    <input type="radio" name="gender" value="female">
                                    <div class="gender-card">
                                        <i class="fas fa-female"></i>
                                        <span>Perempuan</span>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <button type="submit" class="calculate-btn">
                            <i class="fas fa-calculator"></i> Hitung BMI
                        </button>
                    </form>
                </div>

                <div class="calculator-result" id="resultSection">
                    <div class="result-placeholder">
                        <div class="placeholder-icon">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <h3>Hasil BMI Akan Muncul Di Sini</h3>
                        <p>Setelah menghitung, Anda akan melihat:</p>
                        <ul class="placeholder-features">
                            <li><i class="fas fa-check-circle"></i> Nilai BMI dan Kategori</li>
                            <li><i class="fas fa-check-circle"></i> Status kesehatan</li>
                            <li><i class="fas fa-check-circle"></i> Rekomendasi kesehatan</li>
                            <li><i class="fas fa-check-circle"></i> Tips personal untuk Anda</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- BMI Categories -->
            <div class="categories-section">
                <h3 class="categories-title"><i class="fas fa-list"></i> Kategori BMI</h3>
                <div class="categories-grid">
                    <div class="category-card underweight">
                        <div class="category-icon">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <h4>Underweight</h4>
                        <p>BMI &lt; 18.5</p>
                        <div class="category-tip">Kekurangan berat badan</div>
                    </div>
                    <div class="category-card normal">
                        <div class="category-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h4>Normal</h4>
                        <p>BMI 18.5 - 24.9</p>
                        <div class="category-tip">Berat badan ideal</div>
                    </div>
                    <div class="category-card overweight">
                        <div class="category-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <h4>Overweight</h4>
                        <p>BMI 25 - 29.9</p>
                        <div class="category-tip">Kelebihan berat badan</div>
                    </div>
                    <div class="category-card obese">
                        <div class="category-icon">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <h4>Obesitas</h4>
                        <p>BMI ≥ 30</p>
                        <div class="category-tip">Obesitas perlu penanganan</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Form submission dengan validasi yang lebih baik
        document.getElementById('bmiForm').addEventListener('submit', function (e) {
            e.preventDefault();

            // Reset error messages
            clearErrors();

            // Get input elements
            const weightInput = document.getElementById('weight');
            const heightInput = document.getElementById('height');
            const ageInput = document.getElementById('age');

            // Get values
            const weight = parseFloat(weightInput.value.replace(',', '.'));
            const height = parseFloat(heightInput.value.replace(',', '.'));
            const age = parseInt(ageInput.value);
            const gender = document.querySelector('input[name="gender"]:checked').value;

            // Validate inputs
            let isValid = true;

            // Validate weight
            if (!weight || isNaN(weight) || weight <= 0) {
                showError('weightError', 'Masukkan berat badan yang valid (lebih dari 0 kg)');
                weightInput.classList.add('error');
                isValid = false;
            } else if (weight > 300) {
                showError('weightError', 'Berat badan maksimal 300 kg');
                weightInput.classList.add('error');
                isValid = false;
            }

            // Validate height
            if (!height || isNaN(height) || height <= 0) {
                showError('heightError', 'Masukkan tinggi badan yang valid (lebih dari 0 cm)');
                heightInput.classList.add('error');
                isValid = false;
            } else if (height > 300) {
                showError('heightError', 'Tinggi badan maksimal 300 cm');
                heightInput.classList.add('error');
                isValid = false;
            } else if (height < 50) {
                showError('heightError', 'Tinggi badan minimal 50 cm');
                heightInput.classList.add('error');
                isValid = false;
            }

            // Validate age
            if (!age || isNaN(age) || age <= 0) {
                showError('ageError', 'Masukkan usia yang valid');
                ageInput.classList.add('error');
                isValid = false;
            } else if (age > 120) {
                showError('ageError', 'Usia maksimal 120 tahun');
                ageInput.classList.add('error');
                isValid = false;
            }

            if (!isValid) {
                return;
            }

            // Convert height to meters
            const heightInMeters = height / 100;

            // Calculate BMI
            const bmi = weight / (heightInMeters * heightInMeters);

            // Determine category based on standard BMI categories
            let category, categoryClass, advice, color, bmiRange;

            if (bmi < 18.5) {
                category = "Underweight";
                categoryClass = "underweight";
                advice = "Anda memiliki berat badan kurang. Disarankan untuk meningkatkan asupan kalori dengan makanan bergizi.";
                color = "#3498db";
                bmiRange = "Kurang dari 18.5";
            } else if (bmi >= 18.5 && bmi < 25) {
                category = "Normal";
                categoryClass = "normal";
                advice = "Selamat! Berat badan Anda ideal. Pertahankan pola makan sehat dan aktivitas fisik rutin.";
                color = "#2ecc71";
                bmiRange = "18.5 - 24.9";
            } else if (bmi >= 25 && bmi < 30) {
                category = "Overweight";
                categoryClass = "overweight";
                advice = "Anda mengalami kelebihan berat badan. Disarankan untuk mengurangi asupan kalori dan meningkatkan aktivitas fisik.";
                color = "#f39c12";
                bmiRange = "25 - 29.9";
            } else {
                category = "Obesitas";
                categoryClass = "obese";
                advice = "Anda mengalami obesitas. Disarankan untuk berkonsultasi dengan dokter atau ahli gizi untuk program penurunan berat badan yang aman.";
                color = "#e74c3c";
                bmiRange = "30 atau lebih";
            }

            // Tentukan halaman tips berdasarkan kategori
            const tipsPages = {
                'underweight': 'tips/underweight.html',
                'normal': 'tips/ideal.html',
                'overweight': 'tips/overweight.html',
                'obese': 'tips/obesitas.html'
            };

            // For very small screens, adjust the display
            const isVerySmallScreen = window.innerWidth <= 384;
            const bmiFontSize = isVerySmallScreen ? "2.2rem" : "3.5rem";
            const categoryFontSize = isVerySmallScreen ? "0.85rem" : "1rem";

            // Display result
            const resultHTML = `
                <div class="result-main ${categoryClass}">
                    <div class="result-header">
                        <div class="result-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="result-title">
                            <h3>Hasil BMI Anda</h3>
                            <p>${age} tahun • ${gender === 'male' ? 'Laki-laki' : 'Perempuan'}</p>
                        </div>
                    </div>
                    
                    <div class="bmi-score">
                        <div class="bmi-number" style="font-size: ${bmiFontSize}">${bmi.toFixed(1)}</div>
                        <div class="bmi-range">Rentang normal: ${bmiRange}</div>
                        <div class="bmi-category ${categoryClass}" style="font-size: ${categoryFontSize}; padding: ${isVerySmallScreen ? '6px 12px' : '10px 20px'}">
                            <i class="fas fa-${categoryClass === 'normal' ? 'check' : categoryClass === 'underweight' ? 'arrow-down' : categoryClass === 'overweight' ? 'exclamation-triangle' : 'times-circle'}"></i>
                            ${category}
                        </div>
                    </div>
                    
                    <div class="bmi-details">
                        <div class="detail-item">
                            <span class="detail-label">Berat Badan</span>
                            <span class="detail-value">${weight.toFixed(1)} kg</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Tinggi Badan</span>
                            <span class="detail-value">${height.toFixed(1)} cm</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Usia</span>
                            <span class="detail-value">${age} tahun</span>
                        </div>
                    </div>
                    
                    <div class="advice-box">
                        <h4><i class="fas fa-lightbulb"></i> Rekomendasi</h4>
                        <p>${advice}</p>
                        ${age < 18 ? '<p class="teen-note"><i class="fas fa-graduation-cap"></i> <strong>Tips untuk remaja:</strong> Fokus pada pola makan bergizi dan aktivitas fisik yang sesuai usia.</p>' : ''}
                    </div>
                    
                    <div class="result-actions">
                        <a href="${tipsPages[categoryClass]}" class="btn-tips">
                            <i class="fas fa-book"></i> Lihat Tips Lengkap
                        </a>
                        <button class="btn-reset" onclick="resetCalculator()">
                            <i class="fas fa-redo"></i> Hitung Lagi
                        </button>
                    </div>
                    
                    <div class="bmi-bar">
                        <div class="bar-labels">
                            <span>Kurang</span>
                            <span>Normal</span>
                            <span>Lebih</span>
                            <span>Obesitas</span>
                        </div>
                        <div class="bar-container">
                            <div class="bar-fill" style="width: ${Math.min((bmi / 40) * 100, 100)}%; background: ${color};"></div>
                            <div class="bar-marker" style="left: ${Math.min((bmi / 40) * 100, 100)}%;">
                                <div class="marker-dot" style="border-color: ${color}"></div>
                            </div>
                        </div>
                        <div class="bar-scale">
                            <span>0</span>
                            <span>10</span>
                            <span>20</span>
                            <span>30</span>
                            <span>40</span>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('resultSection').innerHTML = resultHTML;

            // Adjust layout for very small screens after result
            if (isVerySmallScreen) {
                adjustForVerySmallScreens();
            }

            // Scroll to result smoothly
            document.getElementById('resultSection').scrollIntoView({
                behavior: 'smooth',
                block: 'nearest'
            });
        });

        // Helper functions
        function showError(elementId, message) {
            const errorElement = document.getElementById(elementId);
            if (errorElement) {
                errorElement.textContent = message;
                errorElement.style.display = 'block';
            }
        }

        function clearErrors() {
            document.querySelectorAll('.validation-message').forEach(el => {
                el.textContent = '';
                el.style.display = 'none';
            });
            document.querySelectorAll('input').forEach(input => {
                input.classList.remove('error');
            });
        }

        function resetCalculator() {
            document.getElementById('bmiForm').reset();
            clearErrors();
            document.getElementById('resultSection').innerHTML = `
                <div class="result-placeholder">
                    <div class="placeholder-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <h3>Hasil BMI Akan Muncul Di Sini</h3>
                    <p>Setelah menghitung, Anda akan melihat:</p>
                    <ul class="placeholder-features">
                        <li><i class="fas fa-check-circle"></i> Nilai BMI dan Kategori</li>
                        <li><i class="fas fa-check-circle"></i> Status kesehatan</li>
                        <li><i class="fas fa-check-circle"></i> Rekomendasi kesehatan</li>
                        <li><i class="fas fa-check-circle"></i> Tips personal untuk Anda</li>
                    </ul>
                </div>
            `;
        }

        function adjustForVerySmallScreens() {
            // Ensure all elements fit within screen
            const elements = document.querySelectorAll('.result-main, .bmi-details, .result-actions, .advice-box, .bmi-bar');
            elements.forEach(el => {
                el.style.maxWidth = '100%';
                el.style.boxSizing = 'border-box';
            });

            // Ensure buttons don't overflow
            const buttons = document.querySelectorAll('.btn-tips, .btn-reset');
            buttons.forEach(btn => {
                btn.style.width = '100%';
                btn.style.boxSizing = 'border-box';
            });
        }

        // Input validation dengan user experience yang lebih baik
        document.querySelectorAll('input[type="number"]').forEach(input => {
            // Clean input
            input.addEventListener('input', function () {
                // Allow numbers and one decimal point
                this.value = this.value.replace(/[^0-9.]/g, '');

                // Remove extra decimal points
                const parts = this.value.split('.');
                if (parts.length > 2) {
                    this.value = parts[0] + '.' + parts.slice(1).join('');
                }

                // Remove error state when user starts typing
                this.classList.remove('error');
                const errorId = this.id + 'Error';
                const errorElement = document.getElementById(errorId);
                if (errorElement) {
                    errorElement.style.display = 'none';
                }
            });

            // Validate on blur with better UX
            input.addEventListener('blur', function () {
                const value = parseFloat(this.value.replace(',', '.'));
                const min = parseFloat(this.min);
                const max = parseFloat(this.max);

                if (this.value.trim() === '') return;

                if (isNaN(value)) {
                    this.classList.add('error');
                    showError(this.id + 'Error', 'Masukkan angka yang valid');
                    return;
                }

                // For weight: 1-300 kg
                if (this.id === 'weight') {
                    if (value < 1) {
                        this.value = 1;
                        showError(this.id + 'Error', 'Berat badan minimal 1 kg');
                        this.classList.add('error');
                    } else if (value > 300) {
                        this.value = 300;
                        showError(this.id + 'Error', 'Berat badan maksimal 300 kg');
                        this.classList.add('error');
                    }
                }

                // For height: 50-300 cm
                if (this.id === 'height') {
                    if (value < 50) {
                        this.value = 50;
                        showError(this.id + 'Error', 'Tinggi badan minimal 50 cm');
                        this.classList.add('error');
                    } else if (value > 300) {
                        this.value = 300;
                        showError(this.id + 'Error', 'Tinggi badan maksimal 300 cm');
                        this.classList.add('error');
                    }
                }

                // For age: 1-120 years
                if (this.id === 'age') {
                    if (value < 1) {
                        this.value = 1;
                        showError(this.id + 'Error', 'Usia minimal 1 tahun');
                        this.classList.add('error');
                    } else if (value > 120) {
                        this.value = 120;
                        showError(this.id + 'Error', 'Usia maksimal 120 tahun');
                        this.classList.add('error');
                    }
                }
            });

            // Allow keyboard navigation
            input.addEventListener('keydown', function (e) {
                // Allow: backspace, delete, tab, escape, enter, decimal point
                if ([46, 8, 9, 27, 13, 110, 190].indexOf(e.keyCode) !== -1 ||
                    // Allow: Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
                    (e.keyCode === 65 && e.ctrlKey === true) ||
                    (e.keyCode === 67 && e.ctrlKey === true) ||
                    (e.keyCode === 86 && e.ctrlKey === true) ||
                    (e.keyCode === 88 && e.ctrlKey === true) ||
                    // Allow: home, end, left, right
                    (e.keyCode >= 35 && e.keyCode <= 39)) {
                    return;
                }

                // Ensure that it is a number and stop the keypress if not
                if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
                    e.preventDefault();
                }
            });
        });

        // Handle window resize for responsive adjustments
        window.addEventListener('resize', function () {
            if (window.innerWidth <= 384) {
                document.body.style.padding = '10px';
                document.querySelector('.container').style.padding = '0 10px';
            }
        });

        // Initial check for small screens
        if (window.innerWidth <= 384) {
            document.body.style.padding = '10px';
            document.querySelector('.container').style.padding = '0 10px';
        }
    </script>
</body>

</html>